function addPage(i,e){e.turn("pages");var t=$("<div />",{});e.turn("addPage",t,i)&&(t.html('<div class="gradient"></div><div class="loader"></div>'),loadPage(i,t))}function loadPage(i,e){var t=$("<img />");t.mousedown((function(i){i.preventDefault()})),t.load((function(){$(this).css({width:"100%",height:"100%"}),$(this).appendTo(e),e.find(".loader").remove()})),t.attr("src","pages/"+i+".jpg"),loadRegions(i,e)}function zoomTo(i){setTimeout((function(){$(".magazine-viewport").data().regionClicked?$(".magazine-viewport").data().regionClicked=!1:1==$(".magazine-viewport").zoom("value")?$(".magazine-viewport").zoom("zoomIn",i):$(".magazine-viewport").zoom("zoomOut")}),1)}function loadRegions(i,e){$.getJSON("pages/"+i+"-regions.json").done((function(i){$.each(i,(function(i,t){addRegion(t,e)}))}))}function addRegion(i,e){var t=$("<div />",{class:"region  "+i.class}),n=$(".magazine").turn("options"),a=n.width/2,o=n.height;t.css({top:Math.round(i.y/o*100)+"%",left:Math.round(i.x/a*100)+"%",width:Math.round(i.width/a*100)+"%",height:Math.round(i.height/o*100)+"%"}).attr("region-data",$.param(i.data||"")),t.appendTo(e)}function regionClick(i){var e=$(i.target);if(e.hasClass("region")){$(".magazine-viewport").data().regionClicked=!0,setTimeout((function(){$(".magazine-viewport").data().regionClicked=!1}),100);var t=$.trim(e.attr("class").replace("region",""));return processRegion(e,t)}}function processRegion(i,e){switch(data=decodeParams(i.attr("region-data")),e){case"link":window.open(data.url);break;case"zoom":var t=i.offset(),n=$(".magazine-viewport").offset(),a={x:t.left-n.left,y:t.top-n.top};$(".magazine-viewport").zoom("zoomIn",a);break;case"to-page":$(".magazine").turn("page",data.page)}}function loadLargePage(i,e){var t=$("<img />");t.load((function(){var i=e.find("img");$(this).css({width:"100%",height:"100%"}),$(this).appendTo(e),i.remove()})),t.attr("src","pages/"+i+"-large.jpg")}function loadSmallPage(i,e){var t=e.find("img");t.css({width:"100%",height:"100%"}),t.unbind("load"),t.attr("src","pages/"+i+".jpg")}function isChrome(){return-1!=navigator.userAgent.indexOf("Chrome")}function disableControls(i){1==i?$(".previous-button").hide():$(".previous-button").show(),i==$(".magazine").turn("pages")?$(".next-button").hide():$(".next-button").show()}function resizeViewport(){var i=$(window).width(),e=$(window).height(),t=$(".magazine").turn("options");if($(".magazine").removeClass("animated"),$(".magazine-viewport").css({width:i,height:e}).zoom("resize"),1==$(".magazine").turn("zoom")){var n=calculateBound({width:t.width,height:t.height,boundWidth:Math.min(t.width,i),boundHeight:Math.min(t.height,e)});n.width%2!=0&&(n.width-=1),n.width==$(".magazine").width()&&n.height==$(".magazine").height()||($(".magazine").turn("size",n.width,n.height),1==$(".magazine").turn("page")&&$(".magazine").turn("peel","br"),$(".next-button").css({height:n.height,backgroundPosition:"-38px "+(n.height/2-16)+"px"}),$(".previous-button").css({height:n.height,backgroundPosition:"-4px "+(n.height/2-16)+"px"})),$(".magazine").css({top:-n.height/2,left:-n.width/2})}var a=$(".magazine").offset(),o=e-a.top-$(".magazine").height(),d=(o-$(".thumbnails > div").height())/2;d<0?$(".thumbnails").css({height:1}):($(".thumbnails").css({height:o}),$(".thumbnails > div").css({marginTop:d})),a.top<$(".made").height()?$(".made").hide():$(".made").show(),$(".magazine").addClass("animated")}function numberOfViews(i){return i.turn("pages")/2+1}function getViewNumber(i,e){return parseInt((e||i.turn("page"))/2+1,10)}function moveBar(i){Modernizr&&Modernizr.csstransforms&&$("#slider .ui-slider-handle").css({zIndex:i?-1:1e4})}function setPreview(i){var e=$(_thumbPreview.children(":first")),t=1==(1==i||i==$("#slider").slider("option","max")?1:2)?56:112;_thumbPreview.addClass("no-transition").css({width:t+15,height:88,top:-103,left:($($("#slider").children(":first")).width()-t-15)/2}),e.css({width:t,height:73}),""!==e.css("background-image")&&"none"!=e.css("background-image")||(e.css({backgroundImage:"url(pages/preview.jpg)"}),setTimeout((function(){_thumbPreview.removeClass("no-transition")}),0)),e.css({backgroundPosition:"0px -"+73*(i-1)+"px"})}function largeMagazineWidth(){return 2214}function decodeParams(i){for(var e,t=i.split("&"),n={},a=0;a<t.length;a++)e=t[a].split("="),n[decodeURIComponent(e[0])]=decodeURIComponent(e[1]);return n}function calculateBound(i){var e={width:i.width,height:i.height};if(e.width>i.boundWidth||e.height>i.boundHeight){var t=e.width/e.height;i.boundWidth/t>i.boundHeight&&i.boundHeight*t<=i.boundWidth?(e.width=Math.round(i.boundHeight*t),e.height=i.boundHeight):(e.width=i.boundWidth,e.height=Math.round(i.boundWidth/t))}return e}document.querySelector("body").innerHTML='<div id="canvas"><div class="zoom-icon zoom-icon-in"></div><div class="magazine-viewport"><div class="container"><div class="magazine"><div ignore="1" class="next-button"></div><div ignore="1" class="previous-button"></div></div></div><div class="bottom"><div id="slider-bar" class="turnjs-slider"><div id="slider"></div></div></div></div>';